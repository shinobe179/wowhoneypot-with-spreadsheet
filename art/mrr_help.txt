* このドキュメントは、WOWHoneypot の Match&Response Rule の説明をしています。
- WOWHoneypot は GitHub を参照してください。
--
- Author: @morihi_soc (c) 2017

* 形式
- Match&Response Rule(以下、mrr)は XML 形式のテキストファイルです。
- mrrs タグにすべての要素が含まれます。
-- version 属性は必ず指定してください。
- mrr タグは1つの mrr の要素を含みます。
- mrr タグは、meta タグ、trigger タグ、response タグを必ず含みます。

- meta タグ
-- meta タグは mrr の補助的な情報を記載します。また以下の要素を含みます。
-- mrrid タグ
--- 必須のタグで、1つだけ定義できます。
--- 1000以上、65535 以下の範囲の整数値を指定します。
--- 1000-9999 morihi_soc 公式ルールで使用
--- 10000-20000 自由(ローカルルールで使用することを推奨)
--- 20001-65535 自由
-- enable タグ
-- 必須のタグで、1つだけ定義できます。
--- mrr のマッチング可否を boolean で指定します。True はマッチング可能、False はマッチング除外をします。
-- note タグ
--- 必須ではありません。1つだけ定義できます。
--- mrr について説明文を書くことができます。

- trigger タグ
-- trigger タグに含まれるすべての要素がマッチング判定の結果 True の場合のみ、response タグの応答が返されます。また以下の要素を含みます。
-- method タグ
--- 必須ではありませんが、method タグか、uri タグか、header タグか、body タグのどれかを最低1つは定義しなければなりません。
--- HTTP のリクエストメソッドを指定します。
-- uri タグ
--- 必須ではありませんが、method タグか、uri タグか、header タグか、body タグのどれかを最低1つは定義しなければなりません。
--- URI(パス、ファイル名およびクエリパラメータのすべて)がマッチング対象です。
-- header タグ
--- 必須ではありませんが、method タグか、uri タグか、header タグか、body タグのどれかを最低1つは定義しなければなりません。
--- HTTP のヘッダがマッチング対象です。
-- body タグ
--- 必須ではありませんが、method タグか、uri タグか、header タグか、body タグのどれかを最低1つは定義しなければなりません。
--- HTTP のボディがマッチング対象です。

- response タグ
-- クライアントに返すヘッダとボディを定義します。
-- status タグ
--- 必須ではありません。指定がない場合は"200"(デフォルト値)が返されます。
--- 3桁の数値で指定する必要があります。
-- header タグ
--- name タグ
---- ヘッダ名を定義します。
--- value タグ
---- ヘッダに対応する値を定義します。
-- body タグ
--- 必須のタグで、1つだけ定義できます。
--- HTTP ボディがマッチング対象です。なお GET メソッドや HEAD メソッドであっても、ボディが含まれている場合はマッチングの評価がされます。
--- 文字列は正規表現の形式で書く必要があります。
--- CDATA またはファイルを指定します。CDATA の場合は<![CDATA[と]]>の間に、ファイルの場合は body タグの filename 属性にファイル名を指定してください。ファイルは art ディレクトリ直下に保存してください。
--- CDATA とファイルのどちらも、MRR を定義した XML ファイルを読み込んだ時点でメモリに展開されます。
